# initState 

The function used by ChemModel to initiate the calculation of a chemical
system under specified conditions

## SYNOPSIS
~~~~
[state, report] = chem.initState(constraint)
~~~~

Solves the chemical system given the contraints provided by the user. 

~~~~
[state, report]  = chem.initState(constraint, 'state', state)
~~~~

Uses additional parameters inside of a predefined state structure, namely temeprature. 

~~~~
[state, report]  = chem.initState(constraint, 'chargeBalance', element)
~~~~

Enforces strict charge balance as an additional equation. By default charge balance is not enforced.

## OUTPUT
 
### state

A structure containing the solution to the
chemical system. This includes state.masterCompoents and
state.components. masterComponents contains the total
element concentrations and surface functional group
concentrations. components contains the species
concentrations as well as the surface acitivity
multipliers. Values can be retreived from state using the
model.getProp() function.

### report

Nonlinear solver output with information regarding the newton steps and convergence criteria. 

## EXAMPLE

~~~~
elementNames = {'H', 'O'};
speciesNames = {'H+*', 'OH-', 'H2O*'};
reactions = {'H2O <-> H+ + OH-', 1e-14*mol/litre};

chem = ChemModel( elementNames, speciesNames, reactions)

constraint = [1e-7, 1]*mol/litre;

state = chem.initState(constraint)
~~~~

Here the system is solved given a H+ concentration of 1e-7 mol/litre.
The order of concentrations in userInput is identical to the order that
they are defined in the chemical system, and can also be found in 
chem.inputNames.

## DESCRIPTION
A function used to solve the chemical system generated by
ChemModel according to constraints given in userInput.

This is accomplished in four steps
1. Parsing the input given to the correct input parameters as defined by the user.
2. Calculation of an initial guess.
3. Solving the chemical system.
4. Enforcing charge balance (optional). 

## REQUIRED PARAMETERS
   
### userInput        

A matrix containing the values of elements
or species specified as inputs during the generation of the
chemical system using ChemModel. userInput must have as
mnay columns as there are specified knowns, which is equal
to the number of entries in elements. 
           

## OPTIONAL PARAMETERS
   
### state 

~~~~
state.temperature = 170*Kelvin;

state = model.initState(userInput, 'state', state)
~~~~

A structure containg information about the
physical model. Currently the only relevant information for 
the chemical system is state.temperature. This is an
optional parameter, when not provided temperature is
assumed to be 298 K. Should be given as a 'key'/value pair.

### chargeBalance 

~~~~
state = model.initState(userInput, 'chargeBalance', 'Cl')
~~~~

This input toggles the enforcment of strict
charge balance. A master component must be specified. If
charge balance is not satisfied with the given constraint
the solver will adjust the total concentration of the
specified element to enforce charge balance. chargeBalance
must be given as a 'key'/value pair. The specified element
must be one of the elements provided as an input. By
defualt charge balance is not strictly enforced. This make
the chemical solver more robust. 