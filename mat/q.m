function I = q(G,f)

%

% n = 4;
%   xs = [ ...
%     -.2677028585910073,0.1510931841533142, ...
%     -.1367699195237390,0.8067449309051964 ];
%   ys = [ ...
%     0.5939017006199488E-01,0.4354087732476309, ...
%     -.3280341115590410,-.3400977314285288 ];
%   zs = [ ...
%     -.3969426941142150,0.2151719254306919, ...
%     0.2950846519937133,-.3430378951002550 ];

Xq = [-.2677028585910073,  .5939017006199488E-01, -.3969426941142150; ...
       .1510931841533142,  .4354087732476309,      .2151719254306919; ...
      -.1367699195237390, -.3280341115590410,      .2950846519937133; ...
       .8067449309051964, -.3400977314285288,     -.3430378951002550];

  w = [ ...
    0.2918008865477151,0.2706884392356724, ...
    0.3098349601753470,0.9865925745591227E-01 ];

  
  v1(1) = - 1.0;
  v1(2) = - 1.0 / sqrt ( 3.0 );
  v1(3) = - 1.0 / sqrt ( 6.0 );
    
  v1 = [v1(1), v1(2), v1(3)]
  
  v2(1) =   0.0;
  v2(2) =   2.0 / sqrt ( 3.0 );
  v2(3) = - 1.0 / sqrt ( 6.0 );

  v2 = [v2(1), v2(2), v2(3)]
  
  v3(1) =   1.0;
  v3(2) = - 1.0 / sqrt ( 3.0 );
  v3(3) = - 1.0 / sqrt ( 6.0 );

  v3 = [v3(1), v3(2), v3(3)]
  
  
  v4(1) =   0.0;
  v4(2) =   0.0;
  v4(3) =   3.0 / sqrt ( 6.0 );
  
  v4 = [v4(1), v4(2), v4(3)]
  
  v = [v1;v2;v3;v4];
  
  X = [0,0,0; 1,0,0; 0,1,0; 0,0,1];
  
  
  A = (v(1:end-1,:)-v(2:end,:))\(X(1:end-1,:) - X(2:end,:));
  b = X(1,:) - v(1,:)*A;
  
  D = abs(det(A));
  
  f = @(X) X(:,1)
  
  
  
  w*D*f(Xq*A + repmat(b,4,1))
  
%   tetramesh([1,2,3,4],v)
  
end